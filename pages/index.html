<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" type="text/css" href="../layui-v2.5.5/layui/css/layui.css" media="all"/>
	<title></title>
	<style type="text/css">
		html,body{
			width: 100%;
		}
		.layui-carousel{
			background: none!important;
		}
		a{
			text-decoration: none;
		}
		li{
			list-style: none;
		}
		.layui-input{
			width: 75%;
		}
	</style>
</head>
<body>
	<!-- 轮播 -->
	<div class="layui-carousel" id="test1" style="min-width: 1184px;">
	  <div carousel-item>
	    <div style="background: url(../img/07c1c08517b273413f3519858f2eba2.jpg) no-repeat;background-size: cover; width: 100%;"></div>
		<div style="background: url(../img/6f51344f46a796a86e999680fa60348.jpg) no-repeat;background-size: cover; width: 100%;"></div>
	  </div>
	  
	  <div style="position: absolute;top: 30px; width: 100%; height: 50px; box-sizing: border-box; padding: 0px 30px; display: flex;justify-content: space-between;">
			<div>
				<img src="../img/logo.jpg" style="height: 50px; width: 94px;" >
			</div>
			<div style="font-size: 16px;color: white;display: flex; font-size: 16px;">
				<div style="margin-right: 50px;line-height: 30px;">别墅 住宅 公寓 商铺 写字楼 小程序 APP</div>
				<div style="display: flex;">
					<img src="../img/login-icon.png" style="height: 30px; width: 30px;">
					<div class="login-box">
					</div>
				</div>
			</div>
	  </div>
	</div>
	
	<!-- 热卖新房 -->
	<div style="width: 1178px; margin: auto;background: none;box-sizing: border-box; margin-top: 50px;">
		<div>
			<div style="display: flex;justify-content: space-between;">
				<div>
					<span style="font-size: 30px; font-weight: bold;">热卖新房</span> 
					<span>享受平台专特价</span>
				</div>
				<div><a href="./more.html">查看更多</a></div>
			</div>
			
			<div style="height: 50px;margin-top: 20px;">
				<button type="button" class="layui-btn layui-btn-primary">桂城</button>
				<button type="button" class="layui-btn layui-btn-primary">朝安</button>
				<button type="button" class="layui-btn layui-btn-primary">三水</button>
				<button type="button" class="layui-btn layui-btn-primary">桂城</button>
				<button type="button" class="layui-btn layui-btn-primary">千灯湖</button>
			</div>
		</div>
		<div style="margin-top: 30px;">
			<ul style="display: flex; justify-content: space-between;">
				<li style="height: 288px;width: 30%;"><img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="height: 100%; width: 100%;"></li>
				<li style="height: 288px;width: 30%;"><img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="height: 100%; width: 100%;"></li>
				<li style="height: 288px;width: 30%;"><img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="height: 100%; width: 100%;"></li>
			</ul>
		</div>
	</div>
	<!-- 热卖新房end -->
	
	<!-- 经纪人推荐 -->
	<div style="background: rgb(247,247,247);padding:50px 0px;">
		<div style="width: 1178px; margin: auto;box-sizing: border-box;">
			<div>
				<div style="display: flex;justify-content: space-between;">
					<div>
						<span style="font-size: 30px; font-weight: bold;">找好经纪</span> 
						<span>经纪全网经纪人直卖平台，找好经纪买好房</span>
					</div>
					<div> </div>
				</div>
			</div>
			
			<div style="margin-top: 30px;">
				<ul style="display: flex; justify-content: space-between;">
					<li style="height: 308px;width: 228px;background: url('https://fs.esf.fangdd.com/efab/FizVBExbKvtdHNateMb9834G1zp1.png') no-repeat;">
						<div style="text-align: center;">
							<img src="../img/01.png"  style="height: 80px;width: 80px;border-radius: 50%;margin-top: 50px;">
							<div>刘铭</div>
							<div>主营: 禅城-南海</div>
							<div style="padding: 20px 0px;">
								<button type="button" class="layui-btn layui-btn-xs">开车看房</button>
								<button type="button" class="layui-btn layui-btn-xs">投资指导</button>
								<button type="button" class="layui-btn layui-btn-xs">首付金融</button>
							</div>
							<div>
								<button type="button" class="layui-btn layui-btn-primary">在线咨询</button>
							</div>
						</div>
					</li>
					<li style="height: 308px;width: 228px;background: url('https://fs.esf.fangdd.com/efab/FizVBExbKvtdHNateMb9834G1zp1.png') no-repeat;">
						<div style="text-align: center;">
							<img src="../img/01.png"  style="height: 80px;width: 80px;border-radius: 50%;margin-top: 50px;">
							<div>刘铭</div>
							<div>主营: 禅城-南海</div>
							<div style="padding: 20px 0px;">
								<button type="button" class="layui-btn layui-btn-xs">开车看房</button>
								<button type="button" class="layui-btn layui-btn-xs">投资指导</button>
								<button type="button" class="layui-btn layui-btn-xs">首付金融</button>
							</div>
							<div>
								<button type="button" class="layui-btn layui-btn-primary">在线咨询</button>
							</div>
						</div>
					</li>
					<li style="height: 308px;width: 228px;background: url('https://fs.esf.fangdd.com/efab/FizVBExbKvtdHNateMb9834G1zp1.png') no-repeat;">
						<div style="text-align: center;">
							<img src="../img/01.png"  style="height: 80px;width: 80px;border-radius: 50%;margin-top: 50px;">
							<div>刘铭</div>
							<div>主营: 禅城-南海</div>
							<div style="padding: 20px 0px;">
								<button type="button" class="layui-btn layui-btn-xs">开车看房</button>
								<button type="button" class="layui-btn layui-btn-xs">投资指导</button>
								<button type="button" class="layui-btn layui-btn-xs">首付金融</button>
							</div>
							<div>
								<button type="button" class="layui-btn layui-btn-primary">在线咨询</button>
							</div>
						</div>
					</li>
					<li style="height: 308px;width: 228px;background: url('https://fs.esf.fangdd.com/efab/FizVBExbKvtdHNateMb9834G1zp1.png') no-repeat;">
						<div style="text-align: center;">
							<img src="../img/01.png"  style="height: 80px;width: 80px;border-radius: 50%;margin-top: 50px;">
							<div>刘铭</div>
							<div>主营: 禅城-南海</div>
							<div style="padding: 20px 0px;">
								<button type="button" class="layui-btn layui-btn-xs">开车看房</button>
								<button type="button" class="layui-btn layui-btn-xs">投资指导</button>
								<button type="button" class="layui-btn layui-btn-xs">首付金融</button>
							</div>
							<div>
								<button type="button" class="layui-btn layui-btn-primary">在线咨询</button>
							</div>
						</div>
					</li>
					<li style="height: 308px;width: 228px;background: url('https://fs.esf.fangdd.com/efab/FizVBExbKvtdHNateMb9834G1zp1.png') no-repeat;">
						<div style="text-align: center;">
							<img src="../img/01.png"  style="height: 80px;width: 80px;border-radius: 50%;margin-top: 50px;">
							<div>刘铭</div>
							<div>主营: 禅城-南海</div>
							<div style="padding: 20px 0px;">
								<button type="button" class="layui-btn layui-btn-xs">开车看房</button>
								<button type="button" class="layui-btn layui-btn-xs">投资指导</button>
								<button type="button" class="layui-btn layui-btn-xs">首付金融</button>
							</div>
							<div>
								<button type="button" class="layui-btn layui-btn-primary">在线咨询</button>
							</div>
						</div>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<!-- 经纪人推荐 -->
	
	<!-- 优选新房 -->
	<div style="width: 1178px; margin: auto;background: none;box-sizing: border-box; margin-top: 50px; padding-bottom: 50px;">
		<div>
			<div style="display: flex;justify-content: space-between;">
				<div>
					<span style="font-size: 30px; font-weight: bold;">优选新房</span> 
					<span>优先新房为你推荐</span>
				</div>
				<div><a href="./more.html">查看更多</a></div>
			</div>
		</div>
		<div style="margin-top: 30px; display: flex;justify-content: space-between; flex-wrap: wrap;">
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
			<div style="width: 265px;height: 270px;">
				<img src="../img/6f51344f46a796a86e999680fa60348.jpg" style="width: 265px;height: 205px; border-radius: 7px;" >
				<div>独栋·精装小洋房 广佛滘口A社区</div>
				<div style="display: flex;justify-content: space-between;">
					<div style="font: 15px;color: #A8A8A8;">黄岐/3室2厅</div>
					<div style="font: 20px;color: #00FF00;">9215元/m²起</div>
				</div>
			</div>
		</div>
		<div style="text-align: center;"><button type="button" class="layui-btn layui-btn-primary  layui-btn-lg">查看更多</button></div>
	</div>
	
	<footer style="height: 200px; min-width: 1194px; background:#121212;">
		<di style="width: 1178px; text-align: center; color: rgb(117,117,117);">
			<div style="border-bottom: 1px solid #D9D9D9;padding: 20px;">佛山市采房有限公司</div>
			<div style="padding-top: 20px;">
				关于我们 | 联系我们 | 用户协议 | 友情链接 | 广告服务 | 用户须知 | 异常反馈 | 营业执照
			</div>
			<div style="padding-top: 20px;">
				Copyright©2019 粤ICP备19025915号
			</div>
		</div>
	</footer>
</body>


<script src="../layui-v2.5.5/layui/layui.js" type="text/javascript" charset="utf-8"></script>
<script src="../lib/jquery3.41.js" type="text/javascript" charset="utf-8"></script>
<script>
	//域名
	var serverUrl = 'http://192.168.0.101:8081/'
	var msmCode = ''
	
	// 轮播图
	layui.use('carousel', function(){
	  var carousel = layui.carousel;
	  //建造实例
	  carousel.render({
	    elem: '#test1',
	    width: '100%',
		height:'600px',
	    arrow: 'always' //始终显示箭头
	    //,anim: 'updown' //切换动画方式
	  });
	});
	
	// 经纪人
	layui.use('carousel', function(){
	  var carousel = layui.carousel;
	  //建造实例
	  carousel.render({
	    elem: '#test2',
	    width: '100%',
		height:'300px',
		autoplay:false,
		indicator:'none',
	    // arrow: 'always' //始终显示箭头
	    //,anim: 'updown' //切换动画方式
	  });
	});
	
	//登录框
	function login(){
		layui.use('layer', function(){
		  var layer = layui.layer;
		  layer.open({
		    type: 1, 
		    content: `,
				<form class="layui-form" action="#" style="height: 360px; width: 360px;"> 
					<div class="layui-form-item">
						<label class="layui-form-label">手机号</label>
						<div class="layui-input-block">
							<input type="text" name="phone" maxlength="11" lay-verify="required|phone maxlength="11" id="longinPhone" placeholder="请输入您的手机号" autocomplete="off" class="layui-input">
						</div>
					</div>
				    <div class="layui-form-item">
						<label class="layui-form-label">短信验证码</label>
						  <div class="layui-input-block">
							<input type="text" name="code" maxlength="6" placeholder="请输入短信验证码" autocomplete="off" class="layui-input">
							<button type="button" id="loginBtnText" class="layui-btn layui-btn-primary" onclick="getLoginCode()">获取验证码</button>
						</div>
				    </div>
					<div class="layui-input-block">
					    <button class="layui-btn layui-btn-warm" lay-submit lay-filter="loginFrom">立即提交</button>
					</div>
				</form>
			`
		  });
		});              
	}
	
	// 注册框
	function register(){
		layui.use('layer', function(){
		  var layer = layui.layer;
		  layer.title('标题变了',1),
		  layer.open({
		    type: 1, 
		    content: `<form class="layui-form" action="#" style="height: 360px; width: 360px; padding-top:20px">
						<div class="layui-form-item">
							<label class="layui-form-label">姓名</label>
							  <div class="layui-input-block">
								<input type="text" name="number" placeholder="姓名" lay-verify="required" autocomplete="off" class="layui-input">
							</div>
						</div>
						
						<div class="layui-form-item">
							<label class="layui-form-label">手机号</label>
							  <div class="layui-input-block">
								<input type="text" name="phone" placeholder="手机号" lay-verify="required|phone" id="phoneNum" autocomplete="off" class="layui-input">
							</div>
						</div>
						
						<div class="layui-form-item">
							<label class="layui-form-label">密码</label>
							  <div class="layui-input-block">
								<input type="text" name="password" placeholder="密码" lay-verify="required|number"   autocomplete="off" class="layui-input">
							</div>
						</div>
						
						<label class="layui-form-label">短信验证码</label>
						  <div class="layui-input-block">
							<input type="text" name="code" placeholder="请输入短信验证码" maxlength="6" autocomplete="off" class="layui-input">
							<button type="button" class="layui-btn layui-btn-primary" id="registerBtnText" onclick="getRegisterCode()">获取验证码</button>
						</div>
						
						<div class="layui-input-block" style="margin-top:10px">
						    <button class="layui-btn layui-btn-warm" lay-submit lay-filter="registerForm" >一键注册/登录</button>
						</div>
					</form>`
		  });
		});              
	};
	
	// 获取注册验证码
	function getRegisterCode(){
		var phone = $('#phoneNum').val();
		if(!(/^1(3|4|5|6|7|8|9)\d{9}$/.test(phone))){ 
		    alert("手机号码有误，请重填");  
		}else{
			$.ajax({
				type:"post",
				url: serverUrl+'cf-user/getRegisterCaptcha',
				dataType:'json',
				data:{"phone":phone},
				xhrFields: {//允许跨域
					withCredentials: false
				},
				success:function(res){
					if(res.code == 200){
						//返回在验证码放到全局变量
						msmCode = res.data
						// 倒计时
						let timedown = 60
						$('#registerBtnText').text(`${timedown}s`)
						let time = window.setInterval(function(){
							if(timedown<=0){
								clearInterval(time)
								$('#registerBtnText').text(`重新获取验证码`)
								return
							}
							timedown -= 1
							$('#registerBtnText').text(`${timedown}s`)
						},1000)
					}else{
						alert('获取失败')
					}
				}
			});	
		}
	}
	
	// 获取登录验证码
	function getLoginCode(){
		var phone = $('#longinPhone').val();
		if(!(/^1(3|4|5|6|7|8|9)\d{9}$/.test(phone))){ 
		    alert("手机号码有误，请重填");  
		}else{
			$.ajax({
				type:"post",
				url: serverUrl+'/cf-user/getLoginCaptcha',
				dataType:'json',
				data:{"phone":phone},
				success:function(res){
					if(res.code == 200){
						//返回在验证码放到全局变量
						msmCode = res.data
						// 倒计时
						let timedown = 60
						$('#loginBtnText').text(`${timedown}s`)
						let time = window.setInterval(function(){
							if(timedown<=0){
								clearInterval(time)
								$('#loginBtnText').text(`重新获取验证码`)
								return
							}
							timedown -= 1
							$('#loginBtnText').text(`${timedown}s`)
						},1000)
					}else{
						alert('获取失败')
					}
				}
			});	
		}
	}
	
	// 注册表单校验
	layui.use('form', function(){
	  var form = layui.form;
	  var layer = layui.layer;
	  // 确定提交表单
	  form.on('submit(registerForm)', function(data){
		let number = data.field.number
		let phone = data.field.phone
		let password = data.field.password
		let code =  data.field.code
		console.log(`用户名:${number}+手机号:${phone}+验证码:${code}+ 密码:${password}`);
		if(msmCode!=code){
			alert('验证码错误')
		}else{
			$.ajax({
				type:'post',
				url:serverUrl+"/cf-user/register",
				dataType:'json',
				data:{
					"number":number,
					"phone":phone,
					"password":password,
				},
				xhrFields: {//允许跨域
					withCredentials: false
				},
				success:function(res){
					if(res.code==200){
						$('.login-box').children().empty()
						$('.login-box').append(`<span onclick="myMsg()">${phone}</span> / <span onclick="Logout()">退出</span>`)
						localStorage.setItem("phone", phone);
						console.log(msmCode)
						layer.closeAll();
					}
				}
			})
		}
		return false;
	  });
	});
	
	// 登录表单验证
	layui.use('form', function(){
	  var form = layui.form;
	  var layer = layui.layer;
	  // 确定提交表单
	  form.on('submit(loginFrom)', function(data){
		let phone = data.field.phone
		let code =  data.field.code
		console.log(`手机号:${phone}+验证码:${code}`);
		if(msmCode!=code){
			alert('验证码错误')
		}else{
			$.ajax({
				type:'post',
				url:serverUrl+"/cf-user/phoneLogin",
				dataType:'json',
				data:{
					"phone":phone,
				},
				success:function(res){
					if(res.code==200){
						$('.login-box').children().empty()
						$('.login-box').append(`<span onclick="myMsg()">${phone}</span> / <span onclick="Logout()">退出</span>`)
						localStorage.setItem("phone", phone);
						layer.closeAll();
					}
				}
			})
		}
		return false;
	  });
	});
	
	//退出登录
	function Logout(){
		localStorage.removeItem("phone");　　
		console.log('退出')
		hasLogin()
	}
	
	// 判断用户是有有登录
	function hasLogin(){
		var	phoneStorage = localStorage.getItem('phone')
		if(phoneStorage!=null){
			$('.login-box').children().empty()
			$('.login-box').append(`<div><span onclick="myMsg()">${phoneStorage}</span> / <span onclick="Logout()">退出</span></div>`)
		}else{
			$('.login-box').children().empty()
			$('.login-box').append(`<div><span onclick="login()">登录</span> / <span onclick="register()">注册</span></div>`)
		}
		console.log(phoneStorage)
	}
	
	// 查看是否有登录
	$(function(){
		hasLogin()
	})
</script>
</html>